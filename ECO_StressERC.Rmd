---
title: "Perceived Stress Predicts Emotion Regulation Choice: The Role of Cognitive Resources, Depressive Symptoms, and Beliefs"
author: "Mengzhe Wei, Tammy English"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: journal
    toc: yes
    toc_float:
      collapsed: true
---

# ECO Stress and ER Choice Analysis
Notes: Started 17 Sep 2024 by Mengzhe Wei to run analysis looking at ER Decisions and strategy selection based on stress. 
Within person (level 1): stress level in EMA
Between person (level 2): Perceived stress scale
Moderators: CES-D, dweck.sum (implicit beliefs about emotion), MCI groups (young, CN, MCI), cogflu.uc (cognitive fluid score uncorrected)
Outcome variables: 
1. Whether participant chose to influence their emotions; 
2. the frequency of strategy use

```{r setup, echo=FALSE, eval=FALSE, warning=FALSE, message=FALSE}
# Set up packages and upload data. 
rm(list=ls());
library(boxr);   
box_auth(); 
wustl.box <- TRUE;
#Packages
# library(lme4); library(knitr); library(RColorBrewer); library (kableExtra);library(correlation); library(tidyverse);library(boxr); library(psych)
#Load the dataset
#data_files <- box_ls('278065273295') 
# file_name <- paste0("ECO_ESM_person-level.csv")
# file_id <- box_search(file_name)
# ESM <- box_read(file_id) %>% as.data.frame()
file_name <- paste0("ECO_baseline.csv")
file_id <- box_search(file_name)
survey <- box_read(file_id) %>% as.data.frame()
```

## Data Quality Check

### Dataset Cleaning
Given that many participants also indicated that they did try to influence their emotions despite answering "no" to emotion regulation since the last survey, we decided to include those who indicated that the most recent time that they influence their emotions were 0-1.5 hours before the prompt, if it wasn't captured by the last survey. Since each interval is 2 hours, 0-1.5 should be able to capture the ER between two prompts. I also made three different variables capturing just "at the prompt" to make within-person analysis more accurate. 
```{r dataset, eval=FALSE, echo=FALSE, warning=FALSE, cache=TRUE, message=FALSE}
# Found participants with no PSS score
missing_PSS <- survey %>%
  filter(is.na(perceived_stress_sum))%>%
  select(PID)
#Frequency of influencing their emotions
emotions_influence_summary <- ESM %>%
  group_by(PID) %>%
  summarize(yes_count = sum(esm_influence_emo == 1, na.rm = TRUE),
            yes_percentage = yes_count/63)
hist(emotions_influence_summary$yes_percentage, breaks = 20, border = "black",main = "ESM ER Percentage", xlab = "Percentage of time selecting YES for influencing emotions", ylab = "# of Participants")
#Given that many participants also indicated that they did try to influence their emotions despite answering "no" to emotion regulation since the last survey, we decided to include those who indicated that the most recent time that they influence their emotions were 0-1.5 hours before the prompt, if it wasn't captured by the last survey. Since each interval is 2 hours, 0-1.5 should be able to capture the ER between two prompts.

# Clean up the full dataset for within person
ESM_test <- ESM
ESM_test$day <- (ESM_test$Prompt - 1) %/% 7 + 1
# Determine the day of survey
ESM_test$ER_yes <- NA  # Set NA as default for non-completed surveys
# Loop through each PID
for (pid in unique(ESM_test$PID)) {
  # Subset data for the current PID
  subset_data <- ESM_test[ESM_test$PID == pid, ]
  # Initialize variables to track the last completed survey
  last_completed_time <- NULL
  last_completed_day <- NULL
  # Loop through each row for the current PID
  for (i in 1:nrow(subset_data)) {
    # Check if survey is completed
    if (subset_data$completed[i] == 1) {
      # Check if Start_time is missing (NA)
      if (is.na(subset_data$Start_time[i])) {
        subset_data$ER_yes[i] <- NA  # Assign ER_yes = 0 if Start_time is missing
        next  # Skip to the next row
      }
      # Get current day and time
      current_day <- subset_data$day[i]
      current_time <- as.POSIXct(subset_data$Start_time[i], format = "%H:%M:%S")
      # If it's the first completed survey
      if (is.null(last_completed_time)) {
        if (!is.na(subset_data$esm_influence_emo[i]) && subset_data$esm_influence_emo[i] == 1 || 
            (!is.na(subset_data$esm_time_manage[i]) && subset_data$esm_time_manage[i] %in% 1:4)) {
          subset_data$ER_yes[i] <- 1
        } else {
          subset_data$ER_yes[i] <- 0
        }
        # Update last completed survey info
        last_completed_time <- current_time
        last_completed_day <- current_day
      # If it's not the first completed survey
      } else {
        # Check if it's a new day
        if (current_day != last_completed_day) {
          if (!is.na(subset_data$esm_influence_emo[i]) && subset_data$esm_influence_emo[i] == 1 || 
              (!is.na(subset_data$esm_time_manage[i]) && subset_data$esm_time_manage[i] %in% 1:4)) {
            subset_data$ER_yes[i] <- 1
          } else {
            subset_data$ER_yes[i] <- 0
          }
        } else {
          # Calculate time gap in minutes
          time_gap <- as.numeric(difftime(current_time, last_completed_time, units = "mins"))
          # Check based on time gap and esm_time_manage
          if (!is.na(subset_data$esm_time_manage[i]) && subset_data$esm_time_manage[i] == 1) {
            subset_data$ER_yes[i] <- 1
          } else if (!is.na(subset_data$esm_time_manage[i]) && subset_data$esm_time_manage[i] == 2 && time_gap >= 30) {
            subset_data$ER_yes[i] <- 1
          } else if (!is.na(subset_data$esm_time_manage[i]) && subset_data$esm_time_manage[i] == 3 && time_gap >= 60) {
            subset_data$ER_yes[i] <- 1
          } else if (!is.na(subset_data$esm_time_manage[i]) && subset_data$esm_time_manage[i] == 4 && time_gap >= 90) {
            subset_data$ER_yes[i] <- 1
          } else {
            subset_data$ER_yes[i] <- 0
          }
        }
        # Update last completed time and day
        last_completed_time <- current_time
        last_completed_day <- current_day
      }
    } else {
      # If not completed, assign NA
      subset_data$ER_yes[i] <- NA
    }
  }
  # Update the main dataset with the new ER_yes
  ESM_test[ESM_test$PID == pid, "ER_yes"] <- subset_data$ER_yes
}
#Create strategy selection variables
ESM_test$distr_yes <- ifelse(is.na(ESM_test$ER_yes) | (is.na(ESM_test$esm_howinfluence) & is.na(ESM_test$er_othermethods_distraction)), 
                             NA, 
                             ifelse(
                               ESM_test$ER_yes == 1 & (!is.na(ESM_test$esm_howinfluence) & ESM_test$esm_howinfluence == 10 | 
                                                         !is.na(ESM_test$er_othermethods_distraction) & ESM_test$er_othermethods_distraction == 1), 
                               1, 0))
ESM_test$min_yes <- ifelse(is.na(ESM_test$ER_yes) | (is.na(ESM_test$esm_howinfluence) & is.na(ESM_test$er_othermethods_minimize)), 
                           NA, 
                           ifelse(ESM_test$ER_yes == 1 & 
                                    (!is.na(ESM_test$esm_howinfluence) & ESM_test$esm_howinfluence == 12 | 
                                       !is.na(ESM_test$er_othermethods_minimize) & ESM_test$er_othermethods_minimize == 1), 
                                  1, 0))
ESM_test$reap_yes <- ifelse(is.na(ESM_test$ER_yes) | (is.na(ESM_test$esm_howinfluence) & is.na(ESM_test$er_othermethods_posreapp)), 
                             NA, 
                            ifelse(ESM_test$ER_yes == 1 & 
                            (!is.na(ESM_test$esm_howinfluence) & ESM_test$esm_howinfluence == 11 | 
                             !is.na(ESM_test$er_othermethods_posreapp) & ESM_test$er_othermethods_posreapp == 1), 
                            1, 0))
#Create a new strategy selection that only includes "at the time of the prompt" for more accurate within person response
ESM_test$distr_yes_prompt <- ifelse(is.na(ESM_test$esm_time_manage) | (is.na(ESM_test$esm_howinfluence) & is.na(ESM_test$er_othermethods_distraction)), 
                             NA, 
                             ifelse(
                               ESM_test$esm_time_manage == 1 & (!is.na(ESM_test$esm_howinfluence) & ESM_test$esm_howinfluence == 10 | 
                                                         !is.na(ESM_test$er_othermethods_distraction) & ESM_test$er_othermethods_distraction == 1), 
                               1, 0))
ESM_test$min_yes_prompt <- ifelse(is.na(ESM_test$esm_time_manage) | (is.na(ESM_test$esm_howinfluence) & is.na(ESM_test$er_othermethods_minimize)), 
                           NA, 
                           ifelse(ESM_test$esm_time_manage == 1 & 
                                    (!is.na(ESM_test$esm_howinfluence) & ESM_test$esm_howinfluence == 12 | 
                                       !is.na(ESM_test$er_othermethods_minimize) & ESM_test$er_othermethods_minimize == 1), 
                                  1, 0))
ESM_test$reap_yes_prompt <- ifelse(is.na(ESM_test$esm_time_manage) | (is.na(ESM_test$esm_howinfluence) & is.na(ESM_test$er_othermethods_posreapp)), 
                             NA, 
                            ifelse(ESM_test$esm_time_manage == 1 & 
                            (!is.na(ESM_test$esm_howinfluence) & ESM_test$esm_howinfluence == 11 | 
                             !is.na(ESM_test$er_othermethods_posreapp) & ESM_test$er_othermethods_posreapp == 1), 
                            1, 0))
ESM_clean <- ESM_test[, c("PID", "Group", "completed", "esm_time_manage","esm_stressed",  "ER_yes", "distr_yes", "min_yes", "reap_yes", "distr_yes_prompt", "min_yes_prompt","reap_yes_prompt","sd.cogflu.uc", "perceived_stress_sum", "CES_D_sum", "dweck.sum", "Gender", "Age", "Race2_1", "Race2_2", "Race2_3", "Race2_4", "Race2_5", "Race2_6", "Race2_7")]
write.csv(ESM_clean, "C:/Users/Emotion/Documents/GIT-MW/ECO/ESM_clean.csv")
```

```{r center, eval=TRUE, echo=FALSE, warning=FALSE, cache=TRUE, message=FALSE}
# Set up packages and upload data. 
rm(list=ls());
options(warnPartialMatchDollar=TRUE);   # safety option
library(lme4); library(knitr); library(RColorBrewer); library (kableExtra);library(correlation); library(tidyverse); library(psych); library(data.table)
# Read in dataset
ESM_clean<-fread("ESM_clean.csv")
survey <- fread("ECO_baseline.csv")
data <-ESM_clean %>%
  group_by(PID) %>%
  mutate (Group_code = case_when(Group == 0 ~ -1,  Group == 1 ~ 0, Group == 2 ~ 1),
          Group = factor(Group_code, levels = -1:1, labels = c("YA","CN","MCI")),
          stress_pm = mean(esm_stressed,na.rm=TRUE),
          ER_yes_pm = sum(ER_yes,na.rm = TRUE)/ sum(completed==1,na.rm = TRUE),
          distr_pm = ifelse(sum(ER_yes,na.rm = TRUE) > 0, sum(distr_yes,na.rm = TRUE) / sum(ER_yes,na.rm = TRUE), 0),
          min_pm = ifelse(sum(ER_yes,na.rm = TRUE) > 0, sum(min_yes,na.rm = TRUE) / sum(ER_yes,na.rm = TRUE), 0),
          reap_pm = ifelse(sum(ER_yes,na.rm = TRUE) > 0, sum(reap_yes,na.rm = TRUE) / sum(ER_yes,na.rm = TRUE), 0),
          ER_yes_prompt = ifelse(is.na(esm_time_manage), NA, ifelse(esm_time_manage == 1, 1, 0)),
          ER_yes_prompt_pm = sum(esm_time_manage==1,na.rm = TRUE)/sum(completed==1,na.rm = TRUE),
          distr_prompt_pm = ifelse(sum(esm_time_manage==1,na.rm = TRUE) > 0, sum(distr_yes_prompt,na.rm = TRUE) / sum(esm_time_manage==1,na.rm = TRUE), 0),
          min_prompt_pm = ifelse(sum(esm_time_manage==1,na.rm = TRUE) > 0, sum(min_yes_prompt,na.rm = TRUE) / sum(esm_time_manage==1,na.rm = TRUE), 0),
          reap_prompt_pm = ifelse(sum(esm_time_manage==1,na.rm = TRUE) > 0, sum(reap_yes_prompt,na.rm = TRUE) / sum(esm_time_manage==1,na.rm = TRUE), 0)) %>% 
  ungroup()%>%
  mutate(
    stress_gmc = scale(esm_stressed, center = T, scale = F),
    stress_w = esm_stressed - stress_pm,
    stress_b = stress_gmc - stress_w,
    PSS_gmc = scale(perceived_stress_sum, center = T, scale = F),
    CESD_gmc = scale(CES_D_sum, center = T, scale = F),
    IBES_gmc = scale(dweck.sum, center = T, scale = F),
    NIHCB_gmc = scale(sd.cogflu.uc, center = T, scale = F)) %>%
  as.data.frame()
```

### Check internal consistency
```{r Internal consistency, eval=TRUE, echo=TRUE, warning=FALSE, message=FALSE}
#Check internal consistency
CESD <- select(survey,CES_D_1:CES_D_20)
omega(CESD) #alpha=0.93, omega=0.95
PSS <- select(survey,c(perceived_stress_1:perceived_stress_3,perceived_stress_4r,perceived_stress_5r,perceived_stress_6,perceived_stress_7r, perceived_stress_8r,perceived_stress_9,perceived_stress_10))
omega(PSS) #alpha=0.89, omega=0.9
belief <- select(survey,Emotion_Beliefs_1r,Emotion_Beliefs_2,Emotion_Beliefs_3, Emotion_Beliefs_4r)
omega(belief) #alpha=0.75, omega = 0.79
```

### Data distribution and Descriptive Stats
```{r distribution,eval=TRUE, echo=TRUE, warning=FALSE, message=TRUE}
layout(matrix(1:15, 3,5, byrow=TRUE)); 
par(mar = c(2, 2, 2, 1), mgp = c(1.1, 0.2, 0), tcl = -0.3)
#Check distribution of all data; loop through histogram
variables <- c("perceived_stress_sum","CES_D_sum", "dweck.sum","sd.cogflu.uc","stress_pm", "ER_yes_pm","distr_pm", "min_pm","reap_pm","ER_yes_prompt_pm","distr_prompt_pm","min_prompt_pm","reap_prompt_pm")
for (vid in 1:length(variables)) { #vid<-1
  hist(data[[variables[vid]]], breaks = 20, border = "black",main = variables[vid], xlab = variables[vid], ylab = "# of Prompts")
}
par(mfrow = c(1, 1))
# boxplot to check the relationship between cognitive fluid score and cognitive impairment
boxplot(data$sd.cogflu.uc~data$Group, main="cognitive fluid score by cognitive impairment group", xlab= "Group", ylab="Score", 
        col = c("lightblue", "lightgreen", "lightcoral"),
        border = "black",
        notch = TRUE,
        varwidth = TRUE)
#OVerall stats including centered variables
describe(data[variables])
describe(data[c("stress_gmc","stress_w","stress_b","PSS_gmc","CESD_gmc","IBES_gmc","NIHCB_gmc")])
```

### Demographics
```{r Demo, eval=TRUE, echo=TRUE, warning=FALSE, message=FALSE}
#Demo table
demo.sum <- data %>% distinct(PID, .keep_all=TRUE) %>%
  select(PID, Group, Race2_1, Race2_2, Race2_3, Race2_4, Race2_5, Race2_6, Race2_7, 
         Gender, Age)
#Group, 0=young adult, 1=CN older adults, 2=MCI older adult
demo.sum %>%
  count(Group)
#Race
demo.sum %>%
  summarise(
    African_American_Black = mean(Race2_1), 
    American_Indian_Alaskan_Native = mean(Race2_2),
    Asian_Asian_American_Pacific_Islander = mean(Race2_3),
    Middle_Eastern_Arab_American = mean(Race2_4),
    Caucasian_European_American = mean(Race2_5),
    Hispanic_Latino = mean(Race2_6),
    Other = mean(Race2_7)
  )
#Age
demo.sum %>%
  summarise(
    mean_age=mean(Age),
    sd_age=sd(Age),
    min_age=min(Age),
    max_age=max(Age)
  )
#Age group by cognitive group
demo.sum %>%
  group_by(Group) %>%
  summarise(
    mean_age=mean(Age),
    sd_age=sd(Age),
    min_age=min(Age),
    max_age=max(Age)
  )
#Gender
demo.sum %>%
  mutate (Gender = factor(Gender, levels = 0:2, labels = c("male","female","other"))) %>%
  count(Gender)
```

### intraclass correlations of EMA items
```{r EMA cor, echo=TRUE,eval=TRUE,warning=F, message=F}
library(lmerTest)
library(performance)
fit_logit <- glmer(ER_yes ~ 1 + (1 | PID), data = data, family = binomial(link = "logit"))
model_performance(fit_logit) 
#ICC = .463,54% variance is within person
fit_logit <- glmer(distr_yes ~ 1 + (1 | PID), data = data, family = binomial(link = "logit"))
model_performance(fit_logit) 
#ICC = 0.464,54% variance is within person
fit_logit <- glmer(min_yes ~ 1 + (1 | PID), data = data, family = binomial(link = "logit"))
model_performance(fit_logit) 
#ICC = 0.435
fit_logit <- glmer(reap_yes ~ 1 + (1 | PID), data = data, family = binomial(link = "logit"))
model_performance(fit_logit) 
#ICC = 0.48
fit_logit <- glmer(ER_yes_prompt ~ 1 + (1 | PID), data = data, family = binomial(link = "logit"))
model_performance(fit_logit) 
#ICC = 0.434
fit_logit <- glmer(distr_yes_prompt ~ 1 + (1 | PID), data = data, family = binomial(link = "logit"))
model_performance(fit_logit) 
#ICC = 0.510 
fit_logit <- glmer(min_yes_prompt ~ 1 + (1 | PID), data = data, family = binomial(link = "logit"))
model_performance(fit_logit) 
#ICC = 0.588 
fit_logit <- glmer(reap_yes_prompt ~ 1 + (1 | PID), data = data, family = binomial(link = "logit"))
model_performance(fit_logit) 
#ICC = 0.671 
fit0 <- glmer(esm_stressed ~ 1 + (1 | PID), data = data)
model_performance(fit0) 
#ICC = 0.408, 59% variance is within person
```

##Analysis

###Correlation
```{r cor, echo=TRUE,eval=TRUE,warning=F, message=F}
data$PID<-as.numeric(data$PID)
stats<-statsBy(select(data,c("PID","Group_code","esm_stressed","ER_yes","distr_yes","min_yes","reap_yes","distr_yes_prompt","min_yes_prompt","reap_yes_prompt","sd.cogflu.uc","perceived_stress_sum","CES_D_sum","dweck.sum")),group="PID")
#between person correlations
stats$rbg #Between-Person Correlation for Raw Scores
stats$pbg #Between-Person Correlation for Person-Mean Centered Scores
#within person correlations
stats$rwg #Within-Person Correlation for Raw Scores
stats$pwg #Within-Person Correlation for Person-Mean Centered Scores
```

### Association with PSS
```{r PSS, echo=TRUE,eval=TRUE,warning=F, message=F}
# stress predicting whether or not ER strategy was selected
library(car)
ER <- lm(ER_yes_pm ~ PSS_gmc+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(ER) #higher PSS score is associated with higher percentage of using emotion regulation, effect holds when other variables are controlled for
vif(ER)
# stress predicting ER strategy preference
#distraction
distr <- lm(distr_pm~ PSS_gmc+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(distr) #higher PSS score is associated with higher percentage of using distraction, effect holds when other variables are controlled for
# b = 0.0063495  
vif(distr)
#minimizing
min <- lm(min_pm~ PSS_gmc+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(min) #higher PSS score is associated with higher percentage of using minimizing, effect holds when other variables are controlled for
# b = 0.0026587  
vif(min)
#reappraisal
reap <- lm(reap_pm~ PSS_gmc+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(reap) #higher PSS score is associated with higher percentage of using reappraisal, effect holds when other variables are controlled for
# b = 0.0034515  
vif(reap)
```

### Moderation analysis
```{r PSS mod, echo=TRUE,eval=TRUE,warning=F, message=F}
# stress predicting whether or not ER strategy was selected, CESD
ER <- lm(ER_yes_pm ~ PSS_gmc*CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(ER)
describe(data$CESD_gmc) #for standard deviations
ef <- effects::effect(term="PSS_gmc*CESD_gmc", xlevels= list(CESD_gmc=c(-11.98, 11.98)), mod=ER)
efdata<-as.data.frame(ef) #convert the effects list to a data frame
efdata$CESD_gmc<-as.factor(efdata$CESD_gmc)
ggplot(efdata, aes(x=PSS_gmc, y=fit, color=CESD_gmc,group=CESD_gmc)) + 
    geom_point() + 
    geom_line(size=1.2) +
    geom_ribbon(aes(ymin=fit-se, ymax=fit+se, fill=CESD_gmc),alpha=0.3) + 
    labs(x= "PSS", y="ER use", color="CESD", fill="CESD") +
    theme_classic() + theme(text=element_text(size=12)) + 
    scale_y_continuous(breaks = seq(0, 1, by=0.2), limits=c(0,1)) +
    scale_x_continuous(breaks = seq(-12, 20, by=2), limits=c(-12,20))
# IBES
ER <- lm(ER_yes_pm ~ PSS_gmc*IBES_gmc+CESD_gmc+NIHCB_gmc+Group_code, data=data)
summary(ER)
describe(data$IBES_gmc) #for standard deviations
ef <- effects::effect(term="PSS_gmc*IBES_gmc", xlevels= list(IBES_gmc=c(-3.49, 3.49)), mod=ER)
efdata<-as.data.frame(ef) #convert the effects list to a data frame
efdata$IBES_gmc<-as.factor(efdata$IBES_gmc)
ggplot(efdata, aes(x=PSS_gmc, y=fit, color=IBES_gmc,group=IBES_gmc)) + 
    geom_point() + 
    geom_line(size=1.2) +
    geom_ribbon(aes(ymin=fit-se, ymax=fit+se, fill=IBES_gmc),alpha=0.3) + 
    labs(x= "PSS", y="ER use", color="IBES", fill="IBES") +
    theme_classic() + theme(text=element_text(size=12)) + 
    scale_y_continuous(breaks = seq(0, 1, by=0.2), limits=c(0,1)) +
    scale_x_continuous(breaks = seq(-12, 20, by=2), limits=c(-12,20))
#IBES significantly moderates
#NIHCB
ER <- lm(ER_yes_pm ~ PSS_gmc*NIHCB_gmc+CESD_gmc+IBES_gmc+Group_code, data=data)
summary(ER)
#MCI

# stress predicting ER strategy preference
#distraction
distr <- lm(distr_pm~ PSS_gmc+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(distr) #higher PSS score is associated with higher percentage of using distraction, effect holds when other variables are controlled for
# b = 0.0063495  
#minimizing
min <- lm(min_pm~ PSS_gmc+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(min) #higher PSS score is associated with higher percentage of using minimizing, effect holds when other variables are controlled for
# b = 0.0026587  
#reappraisal
reap <- lm(reap_pm~ PSS_gmc+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(reap) #higher PSS score is associated with higher percentage of using reappraisal, effect holds when other variables are controlled for
# b = 0.0034515  
```

### Association with mean stress score in EMA
```{r PSS, echo=TRUE,eval=TRUE,warning=F, message=F}
# stress predicting whether or not ER strategy was selected
ER <- lm(ER_yes_pm ~ stress_pm+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(ER) #higher ESM stress is associated with higher percentage of using emotion regulation, effect holds when other variables are controlled for
# b = 0.1017433  
# stress predicting ER strategy preference
#distraction
distr <- lm(distr_pm~ stress_pm+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(distr) #higher PSS score is associated with higher percentage of using distraction, effect holds when other variables are controlled for
# b = 0.0478474    
#minimizing
min <- lm(min_pm~ stress_pm+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(min) #higher PSS score is associated with higher percentage of using minimizing, effect holds when other variables are controlled for
# b = 0.0355344    
#reappraisal
reap <- lm(reap_pm~ stress_pm+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(reap) #higher PSS score is associated with higher percentage of using reappraisal, effect holds when other variables are controlled for
# b = 0.0304417    
```

### Hurdle models for strategy use
Given the prevalence of 0 observation for specific strategy use, fit a hurdle model
```{r hurdle pss, echo=TRUE,eval=TRUE,warning=F, message=F}
# stress predicting whether or not ER strategy was selected
library("pscl")
# stress predicting ER strategy preference
#distraction
distr_hurdle <- hurdle(distr_pm~ PSS_gmc+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(distr_hurdle) #higher PSS score is associated with higher percentage of using distraction, effect holds when other variables are controlled for
#minimizing
min_hurdle <- lm(min_pm~ PSS_gmc+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(min_hurdle) #higher PSS score is associated with higher percentage of using minimizing, effect holds when other variables are controlled for
#reappraisal
reap_hurdle <- lm(reap_pm~ PSS_gmc+CESD_gmc+IBES_gmc+NIHCB_gmc+Group_code, data=data)
summary(reap_hurdle) #higher PSS score is associated with higher percentage of using minimizing, effect holds when other variables are controlled for
```


